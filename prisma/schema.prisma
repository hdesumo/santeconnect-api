generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int      @id @default(autoincrement())
  full_name    String
  email        String   @unique
  passwordHash String
  phone        String?
  role         String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  Soignant     Soignant?
  Etablissement Etablissement?
  Documents    Document[]
}

model Soignant {
  id             Int    @id @default(autoincrement())
  userId         Int    @unique
  speciality     String?
  diploma        String?
  experienceYears Int?
  availability   Json?
  location       String?
  bio            String?
  verified       Boolean @default(false)
  user           User   @relation(fields: [userId], references: [id])
  Applications   Application[]
}

model Etablissement {
  id          Int    @id @default(autoincrement())
  userId      Int    @unique
  name        String
  address     String?
  city        String?
  postalCode  String?
  type        String?
  description String?
  user        User   @relation(fields: [userId], references: [id])
  Missions    Mission[]
}

model Mission {
  id                Int    @id @default(autoincrement())
  etablissementId   Int
  title             String
  description       String?
  specialityRequired String?
  startDate         DateTime
  endDate           DateTime
  createdAt         DateTime @default(now())
  status            String   @default("open")
  etablissement     Etablissement @relation(fields: [etablissementId], references: [id])
  Applications      Application[]
}

model Application {
  id         Int      @id @default(autoincrement())
  missionId  Int
  soignantId Int
  appliedAt  DateTime @default(now())
  status     String   @default("pending")
  mission    Mission  @relation(fields: [missionId], references: [id])
  soignant   Soignant @relation(fields: [soignantId], references: [id])
}

model Document {
  id        Int      @id @default(autoincrement())
  userId    Int
  fileUrl   String
  fileType  String?
  uploadedAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
}
